# Project Context: Aegis Auth Service

You are assisting in building **Aegis Auth Service**,
a reusable, production-grade authentication and identity service.

## Project Goals
- Act as a central authentication / identity service
- Reusable across multiple backend services written in different languages
- Designed to be sellable as a product (open-core or paid)
- Production-ready, not a tutorial or demo

## Target Level
- Senior backend engineer (3â€“5 years)
- Code should reflect real-world production standards

## Tech Stack
- NestJS
- TypeScript (strict)
- Clean Architecture
- TypeORM
- PostgreSQL
- JWT (RS256, asymmetric)
- Docker / docker-compose

## Architecture Rules (Very Important)
- Follow Clean Architecture:
  - `domain` must not depend on NestJS, TypeORM, or any framework
  - `application` contains use cases only
  - `infrastructure` contains framework and external concerns
  - `interfaces` contains HTTP controllers and presenters
- Domain entities must be plain TypeScript classes (no decorators)
- Repositories must be defined as interfaces in `domain`
- Infrastructure must implement repository interfaces
- Use explicit transactions where needed
- Avoid over-engineering (no CQRS, no microservices)

## Auth Design Principles
- Central Auth / Identity Service
- JWT must be signed using RS256 (asymmetric keys)
- Other services should be able to verify JWT locally using public keys
- Access + Refresh token with rotation
- Public key exposure via JWKS (`/.well-known/jwks.json`)
- Auth module must be optional and decoupled

## Code Quality Expectations
- Prefer explicit, readable code over clever tricks
- Avoid business logic in controllers
- Avoid ORM logic in domain
- Use meaningful names and clear boundaries
- Handle errors centrally with consistent error codes

## What NOT to do
- Do not implement tutorial-style code
- Do not tightly couple auth with user business logic
- Do not assume a single-service system
- Do not add features unless explicitly requested

## When generating code
- Think in terms of extensibility and reuse
- Consider how this will be used by other teams
- Assume this service will run in production
